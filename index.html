<!DOCTYPE html>
<html>
  <head>
    <title>Beyond Axes</title>
    <meta charset="utf-8">
    <meta name="author" content="Sean Kross" />
    <meta name="date" content="2017-08-03" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/p5/p5.min.js"></script>
    <script src="libs/p5-binding/p5.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Beyond Axes
## Simulating Systems with Interactive Graphics
### Sean Kross
### 2017-08-03

---


&lt;!--
When we think about statistical graphics we most often think about graphs that
visualize one, two, or three dimensions like a box plot or a scatter plot. Those
kinds of graphs help us visualize trends, model fits, and residuals which are
all valuable insights for statisticians. Lately I've become interested in
visualizations beyond the traditional X-Y plane, which I hope can allows us to
communicate new kinds of insights interactively.
--&gt;



background-image: url(https://www.gatesnotes.com/-/media/Images/Articles/About-Bill-Gates/Remembering-Hans-Rosling/hans-rosling-memoriam_2017_article_1200x564_v1.jpg)

&lt;!--
In the past year the public health community has lost a few of its legends
including Hans Rosling, the founder of [Gapminder](https://www.gapminder.org/).
Gapminder does incredible work promoting data about human development and 
enabling the public to have a better understanding of global public health
problems.
--&gt;

---

![](img/ted.png)

[The Best Stats You've Ever Seen](https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen)

&lt;!--
In general I'm not a fan of Ted talks, but Hans Rosling's talk
[*The Best Stats You've Ever Seen*](https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen) is must-see because of his signature
presentation style and his use of interactive graphics. When he gave this talk
in 2006 there were virtually no off-the-shelf interactive graphics packages so
Gapminder built their own, which Dr. Rosling uses during his talk to the
amazement of the audience.

I've been thinking about this talk and about how it conveys intuition in
three dimensions.  Seeing countries rise and fall along human development 
parameters across time allows the audience to think of each country as an
independent agent in a system. As the system evolves Dr. Rosling walks the
audience through how policy changes that were made in each country effect
their movement in the system and the resulting societal improvements.
--&gt;

---
class: center, middle

# Most People Struggle to Understand Models

&lt;!--
As statisticians we're often interested in studying systems - so we create
models that approximate the parameters of a system based on individual
outcomes. However conveying what it is that our models are trying to say is
often difficult. When I look at a table of coefficients from a linear model it
often takes me a few minutes to understand the relationships between terms and
their interactions.
--&gt;

---

![](img/election.png)

&lt;!--
I'm sure you can relate to my experience during the recent Presidential 
election when some of my friends asked me my opinion about certain electoral
prediction models. This graphic shows the outcome of thousands of simulations
run under FiveThirtyEight's model a few days before the election. 
I tried to explain what it means for a model to give a
candidate a ~25% chance of winning, but I still felt that the intuition behind these
predictive models wasn't being conveyed by their creators. After the election
there was considerable outrage by the public which is summed up pretty well by
the following tweet.
--&gt;

---

![](img/flip-tweet.png)

&lt;!--
Anybody who flipped a coin twice would not consider the occurence of two heads
in a row to be a miracle, and yet there is a widespread belief that groups
like FiveThrityEight who took into account a fair amount of uncertainty in their model
"got the election wrong."
--&gt;

---
class: center, middle

# Interactive Model Explanations that I Admire

&lt;!--
Now I'd like to share with you some work that I really admire, work which I
believe conveys an intuition through the user's ability to interact with the
systems being examined.
--&gt;

---
class: center, middle

# The Parable of the Polygons

by Vi Hart and Nicky Case

Based on [Thomas Schelling](https://www.stat.berkeley.edu/~aldous/157/Papers/Schelling_Seg_Models.pdf)'s *Dynamic Models of Segregation*

&lt;!--
The Parable of the Polygons was created by
[Vi Hart](https://twitter.com/vihartvihart) and
[Nicky Case](https://twitter.com/ncasenmare) in order to demonstrate how small
individual biases can have large societal consequences in terms of segregation.
This project is based on the work of Thomas Schelling's [*Dynamic Models of Segregation*](https://www.stat.berkeley.edu/~aldous/157/Papers/Schelling_Seg_Models.pdf).
--&gt;

---

![](img/polygons.png)

[Live Demo](http://ncase.me/polygons/)

&lt;!--
I'm just going to do a quick demo but I really encourage you to
[go play with this application yourself](http://ncase.me/polygons/). In this
model there are two kinds of people, blue squares and yellow triangles. As you
can see some of these shapes are rocking back and forth with their mouths open -
clearly uncomfortable, while other shapes are happy and sitting still. The
unhappy shapes won't be happy unless they're surrounded by a certain percentage
of shapes that are like them. You can click and drag each shape individually to
make it more happy, or you can click the "Start Movin'" button and the unhappy
shapes will randomly move until they find a happy position. Over time you can
see that this environment becomes drastically more segregated, and if you
increase the bias the arrangement of the shapes becomes even more segregated.

I believe this kind of demonstration, where users can adjust model parameters
and witness resulting behavior conveys an intuition about this sociological
model that isn't expressed by showing the relationship between bias and
segregation alone.
--&gt;

---
class: center, middle

# To Build a Better Ballot

by Nicky Case

&lt;!--
Let's look at another example of these types of interactive models, this one
also created by Nicky Case.
--&gt;

---

![](img/ballot.png)

[Live Demo](http://ncase.me/ballot/sandbox/?m=%7B%22s%22%3A%22FPTP%22%2C%22v%22%3A%5B%5B157%2C149%5D%5D%2C%22c%22%3A%5B%5B63%2C100%5D%2C%5B237%2C100%5D%2C%5B266%2C266%5D%5D%2C%22d%22%3A%22The%20Election%20of%201912%22%7D)

&lt;!--
Once again I strongly encourage you to
[play with this on your own](http://ncase.me/ballot/). This interactive model
explores different kinds of voting procedures, most of which have been developed
by political scientists without being put into practice. In this situation I've
set up a reenactment of the US election of 1912. Each little circle in the in
the big square on the screen represents one voter, and with the First Past the
Post electoral rules each dot will vote for the shape that is closest to it. 

Now if you remember your history books you'll recall that in 1912 Woodrow
Wilson (the blue square) was the Democratic challenger to the incumbent
Republican William Howard Taft (the yellow triangle). However Theodore
Roosevelt, a former President and third party candidate entered the race with
a political platform that was close to Taft's. If I drag
Theodore-red-hexagon-Roosevelt slightly up and to the left, you can see that it
creates a "spoiler effect" allowing the blue square (Wilson) to win the
election! However if I leave Teddy where he is and simply change the voting
system to "Score" you can see that the yellow triangle wins the election instead
of the blue square. Users can therefore experiment with different kinds of voter
preferences, numbers of candidates, and voting systems to see how a democratic
process is effected.
--&gt;

---
class: center, middle

# How Can we Empower Folks to Build Interactive Models?

&lt;!--
The two previous interactive models are very engaging and they were enabled
by individuals who have years of art and design experience on top of deep and
dangerous Javascript knowledge. I don't believe it's reasonable to teach every
data scientist to have this level of Javascript fluency, so I was thinking about
how existing technologies could be adapted with current data science
thinking to produce interactive models in this style.

It also would be nice to be able to introduce web technologies and Javascript
within the familiarity of a data scientist's pipeline.
--&gt;

---
class: center, middle

![](img/p5js.svg)

"A Software Sketchbook"

&lt;!--
For a while I've admired the [p5.js](https://p5js.org/) project by
[Lauren McCarthy](https://twitter.com/laurmccarthy) which she developed while at
[NYU ITP](https://twitter.com/ITP_NYU). The p5 library turns your web browser
into a sketchbook, where certain p5 functions create lines, circles, squares,
and other shapes on a webapge.
--&gt;

---
class: center, middle

![](img/p5-doc.png)

&lt;!--
I was looking through the p5 documentation and there are many examples that
look like this page, where first you set up the drawing environment in the
`setup` function, and then you specify what will be drawn in the `draw`
function. This code sketches out a complicated curve, and each `curveVertex`
function call specifies an inflection point in the curve. After seeing several
code examples like this I started to realize...
--&gt;

---
class: center, middle

![](img/p5-doc-box.png)

&lt;!--
...these arguments look like a data frame! The first and second arguments are
just the positions of each vertex on the canvas, but you could imagine binding
other rectangular data to functions in p5.
--&gt;

---
class: center, middle

![](img/p5-plus-r.png)

&lt;!--
Then I started thinking: what if you could combine the data wrangling and
rectangling power of R with the creative expressiveness of p5? In order to test
this idea I started building the [p5](https://github.com/seankross/p5) library
for R, an [htmlwidget](http://www.htmlwidgets.org/) in the style of 
[leaflet](https://github.com/rstudio/leaflet) or [plotly](https://github.com/ropensci/plotly).
Let's go through a few demos now about what you can do with p5 for R.
--&gt;

---


```r
library(p5)

p5() %&gt;%
  createCanvas(100, 100) %&gt;%
  background("#002d72") %&gt;%
  rect(x = 10, y = 10, w = 50, h = 50)
```

<div id="p5-4048277034" style="width:100px;height:100px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-4048277034">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(100,100,null);\np.background('#002d72');\n};","between":";","draw":"p.draw = function() {\np.rect(10,10,50,50);\n};","post":";","data":null,"fn":"wqonaodihp"},"evals":[],"jsHooks":[]}</script>

&lt;!--
All of the following are live examples, meaning that they were rendered within
this R Markdown presentation. Here's a very simple example where first we'll
load the p5 library, then to start this sketch we'll use the `p5()` function,
which acts much like the `leaflet()` function. The `createCanvas()` function
creates a drawing canvas that is 100 by 100 pixels wide, and then the
`background()` function fills the canvas in with Hopkins blue. The `rect()`
function draws a white rectangle starting at the x and y coordinates of 10 with
a height and width of 50 pixels. Similarly to other R packages built with
htmlwidgets each function takes the full p5 sketch as the first argument so that
the pipe operator can be used.
--&gt;

---


```r
library(p5)
library(tibble)

squares &lt;- data_frame(x = c(100, 100, 200, 200),
                      y = c(50, 150, 50, 150),
                      w = rep(40, 4),
                      h = rep(40, 4))

squares %&gt;%
  p5() %&gt;%
  createCanvas(300, 200) %&gt;%
  background("#002d72") %&gt;%
  rect()
```

<div id="p5-8965364798" style="width:300px;height:200px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-8965364798">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(300,200,null);\np.background('#002d72');\n};","between":";","draw":"p.draw = function() {\np.rect(100,50,40,40);\np.rect(100,150,40,40);\np.rect(200,50,40,40);\np.rect(200,150,40,40);\n};","post":";","data":{"x":[100,100,200,200],"y":[50,150,50,150],"w":[40,40,40,40],"h":[40,40,40,40]},"fn":"lmdodqqeus"},"evals":[],"jsHooks":[]}</script>

&lt;!--
In this second example we'll first create a data frame with values for the
position, width, and height of each square. Then we can pipe the data frame
into almost the same code as we had before, except this time the `rect()`
function knows to find the upstream data frame and to draw a rectangle for each
row.
--&gt;

---


```r
p5() %&gt;%
  createCanvas(100, 100) %&gt;%
  background("#DCDCDC") %&gt;%
  arc(50, 55, 50, 50, 0, ~HALF_PI) %&gt;%
  noFill() %&gt;%
  arc(50, 55, 60, 60, ~HALF_PI, ~PI) %&gt;%
  arc(50, 55, 70, 70, ~PI, ~PI+QUARTER_PI) %&gt;%
  arc(50, 55, 80, 80, ~PI+QUARTER_PI, ~TWO_PI)
```

<div id="p5-7871591529" style="width:100px;height:100px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-7871591529">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(100,100,null);\np.background('#DCDCDC');\n};","between":";","draw":"p.draw = function() {\np.arc(50,55,50,50,0,p.HALF_PI,null);\np.noFill();\np.arc(50,55,60,60,p.HALF_PI,p.PI,null);\np.arc(50,55,70,70,p.PI,p.PI+p.QUARTER_PI,null);\np.arc(50,55,80,80,p.PI+p.QUARTER_PI,p.TWO_PI,null);\n};","post":";","data":null,"fn":"nvcsdlvpmx"},"evals":[],"jsHooks":[]}</script>

&lt;!--
You can also specify more complicated shapes and lines with p5. In this example
I'm using some constants that come with the p5.js library which you can access
with the formula operator from R. 
--&gt;

---


```r
library(tibble)

stripes &lt;- data_frame(
  x = rep(0, 7),
  y = cumsum(c(0, rep(30, 6))),
  w = rep(190*2, 7),
  h = rep(15, 7)
)

stripes_ &lt;- stripes %&gt;%
  p5() %&gt;%
  createCanvas(190*2, 200) %&gt;%
  fill("#B22234") %&gt;%
  noStroke() %&gt;%
  rect()

stars_ &lt;- p5() %&gt;%
  fill("#3C3B6E") %&gt;%
  noStroke() %&gt;%
  rect(0, 0, 152, 105)

bind_sketches(stripes_, stars_)
```

&lt;!--
Since p5 allows you to draw using data frames you can use the `bind_sketches()`
function to combine multiple drawings. In this example 13 rectangles are
specified with a data frame, and then they're combined with one rectangle.
--&gt;

---

<div id="p5-1586832263" style="width:504px;height:504px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-1586832263">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(380,200,null);\n};","between":";","draw":"p.draw = function() {\np.fill('#B22234');\np.noStroke();\np.rect(0,0,380,15);\np.rect(0,30,380,15);\np.rect(0,60,380,15);\np.rect(0,90,380,15);\np.rect(0,120,380,15);\np.rect(0,150,380,15);\np.rect(0,180,380,15);\np.fill('#3C3B6E');\np.noStroke();\np.rect(0,0,152,105);\n};","post":";","data":{"x":[0,0,0,0,0,0,0],"y":[0,30,60,90,120,150,180],"w":[380,380,380,380,380,380,380],"h":[15,15,15,15,15,15,15]},"fn":"yjuvybnrqt"},"evals":[],"jsHooks":[]}</script>

&lt;!--
The resulting image is the beginning of drawing an American flag.
--&gt;

---


```r
draw() %&gt;%
  background("#F4F8FC") %&gt;%
  line(~mouseX, 0, ~mouseX, 200) %&gt;%
  sketch(draw = .)
```

<div id="p5-7372369725" style="width:504px;height:504px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-7372369725">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\n};","between":";","draw":"p.draw = function() {\np.background('#F4F8FC');\np.line(p.mouseX,0,p.mouseX,200);\n};","post":";","data":null,"fn":"hertaldpux"},"evals":[],"jsHooks":[]}</script>

&lt;!--
Since this is a lecture about interactive graphics, let's talk about
interactivity with p5! With p5's `mouseX` constant we can draw a line that
appears wherever the mouse is hovering.
--&gt;

---


```r
p5() %&gt;%
  createCanvas(400, 300) %&gt;%
  background("#F4F8FC") %&gt;%
  ellipse(~mouseX, ~mouseY, 30, 30)
```

<div id="p5-9078125390" style="width:400px;height:300px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-9078125390">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(400,300,null);\np.background('#F4F8FC');\n};","between":";","draw":"p.draw = function() {\np.ellipse(p.mouseX,p.mouseY,30,30);\n};","post":";","data":null,"fn":"aixwcksqlv"},"evals":[],"jsHooks":[]}</script>

&lt;!--
We can also draw circles, and we can track the x and y position of the mouse.
--&gt;

---


```r
setup_ &lt;- setup() %&gt;%
  createCanvas(640, 480)
draw_ &lt;- draw() %&gt;%
  js("
      if (mouseIsPressed) {
        fill(0);
      } else {
        fill(255);
      }
  ") %&gt;%
  ellipse(~mouseX, ~mouseY, 80, 80)
sketch(setup = setup_, draw = draw_)
```

<div id="p5-6570965519" style="width:504px;height:504px;" class="p5 html-widget"></div>
<script type="application/json" data-for="p5-6570965519">{"x":{"section":"sketch","pre":";","setup":"p.setup = function() {\np.createCanvas(640,480,null);\n};","between":";","draw":"p.draw = function() {\n\n      if (p.mouseIsPressed) {\n        p.fill(0);\n      } else {\n        p.fill(255);\n      }\n  \np.ellipse(p.mouseX,p.mouseY,80,80);\n};","post":";","data":null,"fn":"tpyjzrogkd"},"evals":[],"jsHooks":[]}</script>

&lt;!--
If you want to add Javascript code directly to a sketch you can do so with 
the `js()` function. This allows users who want to experiment with Javascript to
use it while still in the R environment. This `if` statment turns the brush
on this canvas to black.
--&gt;

---

# Goals:

1. Make it easier to create interactive models in R.
2. Create a bridge for R programmers to learn Javascript.

&lt;!--
This project is still a work in progress, but my hope is that bringing p5 into
R will at least expose more people to the basics of Javascript, though one day
it could even enable folks to create their own interactive models.
--&gt;

---

# Thank You!

Link to this talk: [seankross.com/jsm-talk](http://seankross.com/jsm-talk)

Code for this talk: [github.com/seankross/jsm-talk](https://github.com/seankross/jsm-talk)

Try out p5 in R: [github.com/seankross/p5](https://github.com/seankross/p5)

Find me on Twitter: [@seankross](https://twitter.com/seankross)

&lt;br&gt;&lt;/br&gt;

Special thanks to Drs. Jeff Leek, Roger Peng, and Brian Caffo for supporting me
in this work as part of the Johns Hopkins Data Science Lab.

&lt;!--
👋
--&gt;
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
